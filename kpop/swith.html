<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Discover your NAYA bias and shop exclusive merchandise">
<title>Sunnie Jae's SWITH Shop</title>

<style>
@font-face {
  font-family: "Brat";
  src: url("assets/FUNKHOUS.ttf");
  font-display: swap;
}

:root {
  --primary: #f5f0ff;
  --secondary: #2b1d4f;
  --light: #7a5cff;
  --dark: #9a1dff;
  --accent: #b00b13;
  --transition-speed: 0.3s;
  --ease-out: cubic-bezier(0.16, 1, 0.3, 1);
}

* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

body {
  font-family: system-ui, -apple-system, sans-serif;
  background: var(--primary);
  color: var(--secondary);
  line-height: 1.6;
  overflow-x: hidden;
  transition: background-color var(--transition-speed) var(--ease-out);
}

body.theme-transition * {
  transition: background-color var(--transition-speed) var(--ease-out),
              border-color var(--transition-speed) var(--ease-out),
              color var(--transition-speed) var(--ease-out);
}

/* ================= HEADER ================= */

header {
  background: linear-gradient(135deg, var(--dark), var(--light));
  padding: 2rem 1.5rem;
  text-align: center;
  color: white;
  position: relative;
  overflow: hidden;
}

header::before {
  content: '';
  position: absolute;
  top: -50%;
  left: -50%;
  width: 200%;
  height: 200%;
  background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
  animation: pulse 8s ease-in-out infinite;
  pointer-events: none;
}

@keyframes pulse {
  0%, 100% { transform: scale(1); opacity: 0.5; }
  50% { transform: scale(1.1); opacity: 0.8; }
}

header h1 {
  font-family: "Brat", system-ui;
  font-size: clamp(1.75rem, 5vw, 2.5rem);
  margin-bottom: 1.5rem;
  position: relative;
  text-shadow: 0 2px 10px rgba(0,0,0,0.2);
  letter-spacing: 0.02em;
}

.member-selector {
  display: flex;
  gap: 0.75rem;
  flex-wrap: wrap;
  justify-content: center;
  margin-bottom: 1.25rem;
  position: relative;
}

.member-btn {
  padding: 0.625rem 1.25rem;
  border-radius: 999px;
  border: 2px solid transparent;
  background: rgba(255,255,255,0.2);
  backdrop-filter: blur(10px);
  color: white;
  cursor: pointer;
  font-weight: 600;
  font-size: 0.95rem;
  transition: all 0.2s var(--ease-out);
  position: relative;
}

.member-btn::before {
  content: '';
  position: absolute;
  inset: 0;
  border-radius: 999px;
  background: white;
  opacity: 0;
  transition: opacity 0.2s var(--ease-out);
  z-index: -1;
}

.member-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
}

.member-btn:active {
  transform: translateY(0);
}

.member-btn.active {
  background: white;
  color: var(--secondary);
  box-shadow: 0 4px 16px rgba(0,0,0,0.2);
}

.quiz-btn {
  background: var(--accent);
  color: white;
  border: none;
  border-radius: 999px;
  padding: 0.875rem 2rem;
  font-weight: 700;
  font-size: 1rem;
  cursor: pointer;
  transition: all 0.2s var(--ease-out);
  position: relative;
  box-shadow: 0 4px 16px rgba(0,0,0,0.2);
}

.quiz-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(0,0,0,0.3);
}

.quiz-btn:active {
  transform: translateY(0);
}

/* ================= HERO ================= */

.hero {
  max-width: 1200px;
  margin: 3rem auto;
  padding: 0 1rem;
  border-radius: 1.5rem;
  overflow: hidden;
}

.hero-container {
  border-radius: 1.5rem;
  overflow: hidden;
  box-shadow: 0 20px 60px rgba(0,0,0,0.15);
  position: relative;
  transition: transform 0.3s var(--ease-out);
}

.hero-container:hover {
  transform: scale(1.02);
}

.hero img {
  width: 100%;
  height: clamp(250px, 40vw, 400px);
  object-fit: cover;
  display: block;
  transition: opacity 0.3s ease;
}

.hero img.loading {
  opacity: 0.5;
}

/* ================= PRODUCTS ================= */

main {
  max-width: 1200px;
  margin: 0 auto;
  padding: 3rem 1rem;
}

.section-title {
  font-family: "Brat", system-ui;
  font-size: clamp(1.5rem, 4vw, 2rem);
  text-align: center;
  margin-bottom: 2.5rem;
  color: var(--secondary);
}

.product-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(min(280px, 100%), 1fr));
  gap: 2rem;
}

.product-card {
  background: white;
  border-radius: 1.25rem;
  padding: 1.5rem;
  box-shadow: 0 4px 20px rgba(0,0,0,0.08);
  display: flex;
  flex-direction: column;
  gap: 1rem;
  transition: all 0.3s var(--ease-out);
  position: relative;
}

.product-card:hover {
  transform: translateY(-8px);
  box-shadow: 0 12px 40px rgba(0,0,0,0.15);
}

.product-card img {
  width: 100%;
  height: 240px;
  object-fit: cover;
  border-radius: 1rem;
  transition: transform 0.3s var(--ease-out);
}

.product-card:hover img {
  transform: scale(1.05);
}

.product-card h3 {
  font-family: "Brat", system-ui;
  font-size: 1.1rem;
  color: var(--secondary);
  line-height: 1.3;
}

.wishlist-controls {
  display: flex;
  gap: 0.75rem;
  align-items: center;
  margin-top: auto;
}

.product-card input[type="number"] {
  width: 70px;
  padding: 0.5rem;
  border-radius: 0.625rem;
  border: 2px solid var(--light);
  font-size: 0.95rem;
  transition: border-color 0.2s ease;
}

.product-card input[type="number"]:focus {
  outline: none;
  border-color: var(--dark);
}

.product-btn {
  background: var(--accent);
  color: white;
  border: none;
  border-radius: 999px;
  padding: 0.625rem 1.25rem;
  font-weight: 600;
  font-size: 0.9rem;
  cursor: pointer;
  text-decoration: none;
  display: inline-block;
  text-align: center;
  transition: all 0.2s var(--ease-out);
  flex: 1;
}

.product-btn:hover {
  transform: scale(1.05);
  box-shadow: 0 4px 12px rgba(0,0,0,0.2);
}

.product-btn:active {
  transform: scale(0.98);
}

/* ================= QUIZ ================= */

#quiz {
  display: none;
  max-width: 650px;
  margin: 4rem auto;
  background: white;
  padding: 3rem 2rem;
  border-radius: 1.5rem;
  box-shadow: 0 20px 60px rgba(0,0,0,0.15);
  animation: slideUp 0.4s var(--ease-out);
}

@keyframes slideUp {
  from {
    opacity: 0;
    transform: translateY(30px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

#quiz.active {
  display: block;
}

#quizQuestion {
  font-size: clamp(1.2rem, 3vw, 1.5rem);
  font-weight: 700;
  margin-bottom: 2rem;
  color: var(--secondary);
  text-align: center;
}

#quizAnswers {
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

#quizAnswers button {
  padding: 1rem 1.25rem;
  border-radius: 1rem;
  border: 2px solid var(--light);
  background: white;
  cursor: pointer;
  font-weight: 600;
  font-size: 1rem;
  transition: all 0.2s var(--ease-out);
  text-align: left;
}

#quizAnswers button:hover {
  background: var(--primary);
  border-color: var(--dark);
  transform: translateX(8px);
}

#quizAnswers button:active {
  transform: translateX(8px) scale(0.98);
}

/* ================= RESULT ================= */

#quizResult {
  display: none;
  text-align: center;
  max-width: 600px;
  margin: 4rem auto;
  padding: 3rem 2rem;
  background: white;
  border-radius: 1.5rem;
  box-shadow: 0 20px 60px rgba(0,0,0,0.15);
  animation: slideUp 0.4s var(--ease-out);
}

#quizResult.active {
  display: block;
}

#quizResult img {
  width: min(280px, 90%);
  height: min(280px, 90%);
  object-fit: cover;
  border-radius: 1.25rem;
  margin-bottom: 1.5rem;
  box-shadow: 0 10px 30px rgba(0,0,0,0.15);
}

#resultMemberName {
  font-family: "Brat", system-ui;
  font-size: clamp(1.75rem, 4vw, 2.25rem);
  margin-bottom: 0.75rem;
  color: var(--secondary);
}

#resultDescription {
  font-size: 1.05rem;
  color: #666;
  line-height: 1.6;
  max-width: 400px;
  margin: 0 auto;
}

/* ================= WISHLIST FAB ================= */

#wishlistFab {
  position: fixed;
  bottom: 2rem;
  right: 2rem;
  background: var(--accent);
  color: white;
  width: 64px;
  height: 64px;
  border-radius: 50%;
  border: none;
  font-size: 1.75rem;
  cursor: pointer;
  box-shadow: 0 8px 24px rgba(0,0,0,0.2);
  transition: all 0.3s var(--ease-out);
  z-index: 100;
}

#wishlistFab:hover {
  transform: scale(1.1) rotate(12deg);
  box-shadow: 0 12px 32px rgba(0,0,0,0.3);
}

#wishlistFab:active {
  transform: scale(1.05) rotate(12deg);
}

/* ================= LOADING STATES ================= */

.loading-skeleton {
  background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
  background-size: 200% 100%;
  animation: loading 1.5s ease-in-out infinite;
}

@keyframes loading {
  0% { background-position: 200% 0; }
  100% { background-position: -200% 0; }
}

/* ================= RESPONSIVE ================= */

@media (max-width: 768px) {
  header {
    padding: 1.5rem 1rem;
  }
  
  .hero {
    margin: 2rem auto;
  }
  
  main {
    padding: 2rem 1rem;
  }
  
  .product-grid {
    gap: 1.5rem;
  }
  
  #quiz, #quizResult {
    margin: 2rem 1rem;
    padding: 2rem 1.5rem;
  }
  
  #wishlistFab {
    width: 56px;
    height: 56px;
    font-size: 1.5rem;
    bottom: 1.5rem;
    right: 1.5rem;
  }
}

/* ================= ACCESSIBILITY ================= */

@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

:focus-visible {
  outline: 3px solid var(--accent);
  outline-offset: 2px;
}
</style>
</head>

<body>

<header>
  <h1>Sunnie Jae's SWITH Shop</h1>
  <div id="memberSelector" class="member-selector" role="radiogroup" aria-label="Select member"></div>
  <button class="quiz-btn" onclick="QuizController.start()" aria-label="Take the bias quiz">
    ✨ Take the Bias Quiz
  </button>
</header>

<div class="hero">
  <div class="hero-container">
    <img id="heroImg" src="" alt="Member hero image" loading="eager">
  </div>
</div>

<main>
  <h2 class="section-title">Exclusive Merchandise</h2>
  <div id="productGrid" class="product-grid" role="list"></div>
</main>

<section id="quiz" role="dialog" aria-labelledby="quizQuestion">
  <h2 id="quizQuestion"></h2>
  <div id="quizAnswers" role="radiogroup"></div>
</section>

<section id="quizResult" role="region" aria-live="polite">
  <img id="resultImage" src="" alt="Your bias result">
  <h2 id="resultMemberName"></h2>
  <p id="resultDescription"></p>
</section>

<button id="wishlistFab" onclick="WishlistManager.openEmail()" aria-label="View wishlist">♡</button>

<script>
// =========================
// MEMBER DATA
// =========================
const MEMBERS = {
  SUMIN: {
    name: "SUMIN",
    type: "ENTP",
    palette: {
      primary: "#f5f0ff",
      secondary: "#2b1d4f",
      light: "#7a5cff",
      dark: "#9a1dff",
      accent: "#b00b13"
    },
    heroImage: "assets/hero-SUMIN.png",
    resultImage: "assets/result-SUMIN.png",
    description: "Bold, fast-thinking, and magnetic. You thrive on ideas and chaos."
  },
  SIEUN: {
    name: "SIEUN",
    type: "ISFJ",
    palette: {
      primary: "#fff6ec",
      secondary: "#4a2c1d",
      light: "#ffb26b",
      dark: "#c97a3d",
      accent: "#e63946"
    },
    heroImage: "assets/hero-SIEUN.png",
    resultImage: "assets/result-SIEUN.png",
    description: "Warm, loyal, and deeply caring. You're the heart of every group."
  },
  ISA: {
    name: "ISA",
    type: "ESFJ",
    palette: {
      primary: "#ecfdf3",
      secondary: "#065f46",
      light: "#34d399",
      dark: "#047857",
      accent: "#2563eb"
    },
    heroImage: "assets/hero-ISA.png",
    resultImage: "assets/result-ISA.png",
    description: "Social, grounding, and dependable. Everyone feels safe with you."
  }
};

const PRODUCTS = [
  {
    id: "keychain",
    name: "Lightstick Keychain",
    category: "Exclusive",
    image: "keychain",
    wishlist: true
  },
  {
    id: "phonecase",
    name: "Planet Phone Case",
    category: "Exclusive",
    image: "phonecase",
    wishlist: true
  },
  {
    id: "stickers",
    name: "Sticker Pack",
    category: "Vendor",
    image: "stickers",
    vendors: [{label: "Purchase via Redbubble", url: "https://www.redbubble.com"}]
  }
];

const QUIZ = [
  {letter: "E", question: "You gain energy by:", answers: ["Being around people", "Being alone"]},
  {letter: "N", question: "You trust more:", answers: ["Ideas & patterns", "Concrete facts"]},
  {letter: "T", question: "You decide using:", answers: ["Logic", "Feelings"]},
  {letter: "P", question: "You prefer:", answers: ["Flexibility", "Structure"]},
  {vibe: true, question: "Favorite color?", map: {A: "SUMIN", B: "SIEUN", C: "ISA"}, answers: ["Purple", "Orange", "Blue"]},
  {vibe: true, question: "Favorite animal?", map: {A: "SUMIN", B: "SIEUN", C: "ISA"}, answers: ["Cheetah", "Cat", "Dog"]},
  {vibe: true, question: "Ideal weekend?", map: {A: "SUMIN", B: "SIEUN", C: "ISA"}, answers: ["Exploring", "Resting", "Socializing"]},
  {vibe: true, question: "Your role in a group?", map: {A: "SUMIN", B: "SIEUN", C: "ISA"}, answers: ["Idea starter", "Support", "Leader"]},
  {vibe: true, question: "Music vibe?", map: {A: "SUMIN", B: "SIEUN", C: "ISA"}, answers: ["Hyperpop", "Soft pop", "Anthemic"]},
  {vibe: true, question: "Fashion style?", map: {A: "SUMIN", B: "SIEUN", C: "ISA"}, answers: ["Experimental", "Cozy", "Clean"]}
];

// =========================
// STATE & STORAGE
// =========================
class AppState {
  constructor() {
    this.data = {
      currentBias: this.getItem("bias") || Object.keys(MEMBERS)[0],
      wishlist: JSON.parse(this.getItem("wishlist") || "[]"),
      quizAnswers: [],
      quizIndex: 0
    };
  }
  getItem(k) { try { return localStorage.getItem(k); } catch { return null; } }
  setItem(k, v) { try { localStorage.setItem(k, v); } catch(e) { console.warn("Storage unavailable:", e); } }
  get(k) { return this.data[k]; }
  set(k, v) { this.data[k] = v; }
}

const state = new AppState();

// =========================
// PERFORMANCE
// =========================
const imageCache = new Map();
const preloadImage = (src) => {
  if (imageCache.has(src)) return imageCache.get(src);
  const promise = new Promise((resolve, reject) => {
    const img = new Image();
    img.onload = () => resolve(src);
    img.onerror = reject;
    img.src = src;
  });
  imageCache.set(src, promise);
  return promise;
};

// =========================
// THEME ENGINE
// =========================
const ThemeEngine = {
  cache: null,
  apply(key, instant = false) {
    if (this.cache === key) return;
    this.cache = key;
    const p = MEMBERS[key].palette;
    const r = document.documentElement;
    if (!instant && r.style.getPropertyValue('--primary')) {
      document.body.classList.add('theme-transition');
      setTimeout(() => document.body.classList.remove('theme-transition'), 300);
    }
    requestAnimationFrame(() => {
      Object.entries(p).forEach(([k, v]) => r.style.setProperty(`--${k}`, v));
    });
  },
  preloadAssets(key) {
    const m = MEMBERS[key];
    [m.heroImage, m.resultImage].forEach(src => {
      preloadImage(src).catch(() => preloadImage(`assets/blank-${key}.png`));
    });
  }
};

// =========================
// MEMBER SELECTOR
// =========================
const MemberSelector = {
  render() {
    const box = document.getElementById("memberSelector");
    if (!box) return;
    const frag = document.createDocumentFragment();
    const curr = state.get("currentBias");
    Object.keys(MEMBERS).forEach(k => {
      const btn = document.createElement("button");
      btn.textContent = MEMBERS[k].name;
      btn.className = k === curr ? "member-btn active" : "member-btn";
      btn.setAttribute('role', 'radio');
      btn.setAttribute('aria-checked', k === curr);
      btn.onclick = () => this.select(k);
      frag.appendChild(btn);
    });
    box.innerHTML = "";
    box.appendChild(frag);
  },
  select(key) {
    state.set("currentBias", key);
    state.setItem("bias", key);
    ThemeEngine.apply(key);
    ThemeEngine.preloadAssets(key);
    HeroImage.update();
    ProductGrid.render();
    this.render();
  }
};

// =========================
// HERO
// =========================
const HeroImage = {
  update() {
    const img = document.getElementById("heroImg");
    if (!img) return;
    const curr = state.get("currentBias");
    const src = MEMBERS[curr].heroImage;
    img.classList.add('loading');
    preloadImage(src)
      .then(() => { img.src = src; img.classList.remove('loading'); })
      .catch(() => { img.src = `assets/blank-${curr}.png`; img.classList.remove('loading'); });
  }
};

// =========================
// PRODUCTS
// =========================
const ProductGrid = {
  render() {
    const grid = document.getElementById("productGrid");
    if (!grid) return;
    const frag = document.createDocumentFragment();
    const curr = state.get("currentBias");
    PRODUCTS.forEach(p => frag.appendChild(this.createCard(p, curr)));
    grid.innerHTML = "";
    grid.appendChild(frag);
  },
  createCard(p, m) {
    const card = document.createElement("div");
    card.className = "product-card";
    card.setAttribute('role', 'listitem');
    const title = `${p.name}${p.wishlist ? ` – ${m} ver.` : ""}`;
    const h3 = document.createElement("h3");
    h3.textContent = title;
    card.appendChild(h3);
    const img = document.createElement("img");
    img.alt = p.name;
    img.loading = "lazy";
    img.src = `assets/${p.image}-${m}.png`;
    img.onerror = () => { img.onerror = null; img.src = `assets/blank-${m}.png`; };
    card.appendChild(img);
    if (p.wishlist) {
      const controls = document.createElement("div");
      controls.className = "wishlist-controls";
      const input = document.createElement("input");
      input.type = "number";
      input.min = "1";
      input.value = "1";
      input.id = `qty-${p.id}`;
      input.setAttribute('aria-label', 'Quantity');
      const btn = document.createElement("button");
      btn.className = "product-btn";
      btn.textContent = "Add to Wishlist";
      btn.onclick = () => WishlistManager.add(p.id);
      controls.appendChild(input);
      controls.appendChild(btn);
      card.appendChild(controls);
    } else {
      p.vendors.forEach(v => {
        const link = document.createElement("a");
        link.className = "product-btn";
        link.href = v.url;
        link.target = "_blank";
        link.rel = "noopener noreferrer";
        link.textContent = v.label;
        card.appendChild(link);
      });
    }
    return card;
  }
};

// =========================
// WISHLIST
// =========================
const WishlistManager = {
  add(id) {
    const qty = Number(document.getElementById(`qty-${id}`).value || 1);
    const curr = state.get("currentBias");
    const list = state.get("wishlist");
    list.push({id, member: curr, qty});
    state.set("wishlist", list);
    state.setItem("wishlist", JSON.stringify(list));
    const btn = event.target;
    const orig = btn.textContent;
    btn.textContent = "✓ Added!";
    setTimeout(() => btn.textContent = orig, 1500);
  },
  openEmail() {
    const list = state.get("wishlist");
    if (!list.length) {
      alert("Your wishlist is empty!");
      return;
    }
    const pMap = {};
    PRODUCTS.forEach(p => pMap[p.id] = p.name);
    let body = `Hello Sunnie Jae Team,\n\nI'd like to request the following items from the NAYA Shop:\n\n`;
    const grouped = {};
    list.forEach(i => {
      if (!grouped[i.member]) grouped[i.member] = [];
      grouped[i.member].push(i);
    });
    Object.entries(grouped).forEach(([m, items]) => {
      body += `— ${m} Version —\n`;
      items.forEach(i => body += `• ${pMap[i.id] || i.id} × ${i.qty}\n`);
      body += `\n`;
    });
    body += `Thank you!\n`;
    const subject = encodeURIComponent("NAYA Shop Order Request");
    const emailBody = encodeURIComponent(body);
    window.location.href = `mailto:orders@sunniejae.com?subject=${subject}&body=${emailBody}`;
  }
};

// =========================
// QUIZ
// =========================
const QuizController = {
  start() {
    state.set("quizIndex", 0);
    state.set("quizAnswers", []);
    document.getElementById("quiz").classList.add('active');
    document.getElementById("quizResult").classList.remove('active');
    window.scrollTo({top: document.getElementById("quiz").offsetTop - 100, behavior: 'smooth'});
    this.showQuestion();
  },
  showQuestion() {
    const idx = state.get("quizIndex");
    const q = QUIZ[idx];
    document.getElementById("quizQuestion").textContent = q.question;
    const box = document.getElementById("quizAnswers");
    box.innerHTML = "";
    const frag = document.createDocumentFragment();
    q.answers.forEach((a, i) => {
      const btn = document.createElement("button");
      btn.textContent = a;
      btn.onclick = () => this.answer(i);
      frag.appendChild(btn);
    });
    box.appendChild(frag);
  },
  answer(choice) {
    const idx = state.get("quizIndex");
    const answers = state.get("quizAnswers");
    answers.push({...QUIZ[idx], choice});
    state.set("quizAnswers", answers);
    state.set("quizIndex", idx + 1);
    idx + 1 < QUIZ.length ? this.showQuestion() : this.finish();
  },
  finish() {
    const scores = {};
    Object.keys(MEMBERS).forEach(k => scores[k] = 0);
    const answers = state.get("quizAnswers");
    const mbti = answers.filter(q => q.letter).map(q => q.choice === 0 ? q.letter : this.opposite(q.letter)).join("");
    Object.entries(MEMBERS).forEach(([k, m]) => {
      let match = 0;
      for (let i = 0; i < 4; i++) if (m.type[i] === mbti[i]) match++;
      scores[k] += match * 5;
    });
    answers.filter(q => q.vibe).forEach(q => {
      const member = q.map[String.fromCharCode(65 + q.choice)];
      scores[member] += 3;
    });
    const results = Object.entries(scores).map(([k, v]) => ({key: k, score: v})).sort((a, b) => b.score - a.score);
    const top = results[0];
    const percent = Math.round((top.score / (QUIZ.length * 5)) * 100);
    state.setItem("quiz-result", JSON.stringify({top, percent}));
    this.showResult(top.key, percent);
  },
  showResult(key, percent) {
    state.set("currentBias", key);
    state.setItem("bias", key);
    ThemeEngine.apply(key);
    ThemeEngine.preloadAssets(key);
    HeroImage.update();
    MemberSelector.render();
    ProductGrid.render();
    const img = document.getElementById("resultImage");
    if (img) {
      img.src = MEMBERS[key].resultImage;
      img.onerror = () => { img.src = `assets/blank-${key}.png`; };
    }
    const nameEl = document.getElementById("resultMemberName");
    const descEl = document.getElementById("resultDescription");
    if (nameEl) nameEl.textContent = MEMBERS[key].name;
    if (descEl) descEl.textContent = `${percent}% match — ${MEMBERS[key].description}`;
    document.getElementById("quiz").classList.remove('active');
    document.getElementById("quizResult").classList.add('active');
    window.scrollTo({top: document.getElementById("quizResult").offsetTop - 100, behavior: 'smooth'});
  },
  restore() {
    const saved = JSON.parse(state.getItem("quiz-result"));
    if (saved) this.showResult(saved.top.key, saved.percent);
  },
  opposite(l) {
    return {E: "I", I: "E", N: "S", S: "N", T: "F", F: "T", P: "J", J: "P"}[l];
  }
};

// =========================
// INIT
// =========================
document.addEventListener("DOMContentLoaded", () => {
  MemberSelector.render();
  ThemeEngine.apply(state.get("currentBias"), true);
  ThemeEngine.preloadAssets(state.get("currentBias"));
  HeroImage.update();
  ProductGrid.render();
  QuizController.restore();
});